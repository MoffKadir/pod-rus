window = {
	name = "convention_of_thorns_window"
	size = { 1076 850 }
	position = { 610 100 }
	layer = middle

	visible = "[And(Or(Not(IsObserver), GetPlayer.IsValid), GetPlayer.MakeScope.GetVariable('custom_convention_of_thorns').IsSet)]"
	datacontext = "[GetFaithByKey( 'camahumanity' )]"

	using = Window_Background
	using = Window_Decoration
	using = Animation_ShowHide_Standard

	state = {
		name = _show
		using = Animation_FadeIn_Quick

		on_start = "[GetVariableSystem.Set('thorns_tab_choice','vote')]"
	}

	state = {
		name = _hide
		using = Animation_FadeOut_Quick
	}
	
	state = {
		name = _pause

		trigger_when = "[Not(IsGamePaused)]"
		on_start = "[OnPause]"
	}
	
	vbox = {
		using = Window_Margins
		restrictparent_min = yes

		header_pattern = {
			layoutpolicy_horizontal = expanding

			blockoverride "header_text"
			{
				text = "CONVENTION_OF_THORNS_WINDOW_TITLE"
			}

			blockoverride "button_close"
			{
				visible = no
			}
		}

		vbox = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding
		
			vbox = {
				name = "main"
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding
			
				vbox = {
					name = "doctrine_selection"
					layoutpolicy_horizontal = expanding
					layoutpolicy_vertical = expanding
					minimumsize = { 0 512 }
					margin = { 14 14 }

					background = {
						using = Background_Area
					}
						
					hbox = {
						layoutpolicy_horizontal = expanding
						button_tab = {
							text = "CONVENTION_OF_THORNS_WINDOW_TAB_VOTE"
							layoutpolicy_horizontal = expanding
							onclick = "[GetVariableSystem.Set('thorns_tab_choice','vote')]"
							down = "[GetVariableSystem.HasValue('thorns_tab_choice', 'vote')]"
						}
						button_tab = {
							text = "CONVENTION_OF_THORNS_WINDOW_TAB_MY_VOTE"
							layoutpolicy_horizontal = expanding
							onclick = "[GetVariableSystem.Set('thorns_tab_choice','my_vote')]"
							down = "[GetVariableSystem.HasValue('thorns_tab_choice', 'my_vote')]"
						}
					}
						
					scrollbox = {
						name = "characters_scroll_area"
						layoutpolicy_vertical = expanding
						layoutpolicy_horizontal = expanding

						blockoverride "scrollbox_content" {
							vbox = {
								visible = "[GetVariableSystem.HasValue('thorns_tab_choice', 'vote')]"
									
								text_label_center = {
									text = "CONVENTION_OF_THORNS_WINDOW_CHOOSE_NEW"
								}
								
								thorns_grid = {
									datamodel = "[Faith.MakeScope.GetList('tenet_voted_15_list')]"
								}
								thorns_grid = {
									datamodel = "[Faith.MakeScope.GetList('tenet_voted_14_list')]"
								}
								thorns_grid = {
									datamodel = "[Faith.MakeScope.GetList('tenet_voted_13_list')]"
								}
								thorns_grid = {
									datamodel = "[Faith.MakeScope.GetList('tenet_voted_12_list')]"
								}
								thorns_grid = {
									datamodel = "[Faith.MakeScope.GetList('tenet_voted_11_list')]"
								}
								thorns_grid = {
									datamodel = "[Faith.MakeScope.GetList('tenet_voted_10_list')]"
								}
								thorns_grid = {
									datamodel = "[Faith.MakeScope.GetList('tenet_voted_9_list')]"
								}
								thorns_grid = {
									datamodel = "[Faith.MakeScope.GetList('tenet_voted_8_list')]"
								}
								thorns_grid = {
									datamodel = "[Faith.MakeScope.GetList('tenet_voted_7_list')]"
								}
								thorns_grid = {
									datamodel = "[Faith.MakeScope.GetList('tenet_voted_6_list')]"
								}
								thorns_grid = {
									datamodel = "[Faith.MakeScope.GetList('tenet_voted_5_list')]"
								}
								thorns_grid = {
									datamodel = "[Faith.MakeScope.GetList('tenet_voted_4_list')]"
								}
								thorns_grid = {
									datamodel = "[Faith.MakeScope.GetList('tenet_voted_3_list')]"
								}
								thorns_grid = {
									datamodel = "[Faith.MakeScope.GetList('tenet_voted_2_list')]"
								}
								thorns_grid = {
									datamodel = "[Faith.MakeScope.GetList('tenet_voted_1_list')]"
								}
							}
							
							vbox = {
								visible = "[GetVariableSystem.HasValue('thorns_tab_choice', 'my_vote')]"
								spacing = 10
								margin = { 8 8 }
									
								text_label_center = {
									text = "FAITH_DOCTRINE_CHANGE_WINDOW_CHOOSE_NEW"
								}
									
								dynamicgridbox = {	
									flipdirection = yes
									ignoreinvisible = yes
									maxhorizontalslots = 3
									datamodel_wrap = 3
									datamodel = "[GetAllFaithDoctrines]"
										
									item = {
										button_vote_tenet = { }
									}
								}
							}
						}
					}
				}
			}
		
			vbox = {
				name = "footer"
				layoutpolicy_horizontal = expanding
				margin_bottom = 12

				button_primary = {
					name = "enact_button"
					datacontext = "[GetScriptedGui( 'apply_voted_tenet' )]"
					onclick = "[GetVariableSystem.Toggle( 'convention_of_thorns_tenet_confirm' )]"
					enabled = "[Not(GetVariableSystem.Exists('convention_of_thorns_tenet_confirm'))]"

					text = "CONVENTION_OF_THORNS_WINDOW_CHANGE"

					using = tooltip_above
					tooltip = "[ScriptedGui.BuildTooltip(GuiScope.SetRoot(Faith.MakeScope).AddScope('player',GetPlayer.MakeScope).End)]"
				}
			}
		}
	}
}

window = {
	name = "convention_of_thorns_doctrine_window"
	size = { 1076 850 }
	position = { 610 100 }
	layer = middle

	visible = "[And(Or(Not(IsObserver), GetPlayer.IsValid), GetPlayer.MakeScope.GetVariable('custom_convention_of_thorns_doctrine').IsSet)]"
	datacontext = "[GetFaithByKey( 'camahumanity' )]"

	using = Window_Background
	using = Window_Decoration
	using = Animation_ShowHide_Standard

	state = {
		name = _show
		using = Animation_FadeIn_Quick

		on_start = "[GetVariableSystem.Set('doctrine_tab_choice','main')]"
	}

	state = {
		name = _hide
		using = Animation_FadeOut_Quick
	}
	
	state = {
		name = _pause

		trigger_when = "[Not(IsGamePaused)]"
		on_start = "[OnPause]"
	}
	
	vbox = {
		using = Window_Margins
		restrictparent_min = yes

		header_pattern = {
			layoutpolicy_horizontal = expanding

			blockoverride "header_text"
			{
				text = "CONVENTION_OF_THORNS_WINDOW_TITLE"
			}

			blockoverride "button_close"
			{
				visible = no
			}
		}

		vbox = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding
		
			vbox = {
				name = "main"
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding
			
				vbox = {
					name = "doctrine_selection"
					layoutpolicy_horizontal = expanding
					layoutpolicy_vertical = expanding
					minimumsize = { 0 512 }
					margin = { 14 14 }

					background = {
						using = Background_Area
					}

					expand = {}
						
					hbox = {
						layoutpolicy_horizontal = expanding
						button_tab = {
							text = "FAITH_DOCTRINE_CHANGE_WINDOW_TAB_MAIN"
							layoutpolicy_horizontal = expanding
							onclick = "[GetVariableSystem.Set('doctrine_tab_choice','main')]"
							down = "[GetVariableSystem.HasValue('doctrine_tab_choice', 'main')]"
						}
						button_tab = {
							text = "FAITH_DOCTRINE_CHANGE_WINDOW_TAB_CRIME"
							layoutpolicy_horizontal = expanding
							onclick = "[GetVariableSystem.Set('doctrine_tab_choice','crimes')]"
							down = "[GetVariableSystem.HasValue('doctrine_tab_choice', 'crimes')]"
						}
						button_tab = {
							text = "FAITH_DOCTRINE_CHANGE_WINDOW_TAB_SPLAT"
							layoutpolicy_horizontal = expanding
							onclick = "[GetVariableSystem.Set('doctrine_tab_choice','splats')]"
							down = "[GetVariableSystem.HasValue('doctrine_tab_choice', 'splats')]"
						}
					}

					scrollbox = {
						name = "characters_scroll_area"
						layoutpolicy_vertical = expanding
						layoutpolicy_horizontal = expanding
						datacontext = "[GetPlayer]"

						blockoverride "scrollbox_content" {
							vbox = {
								name = "main_doctrines_selection"
								visible = "[GetVariableSystem.HasValue('doctrine_tab_choice', 'main')]"
								spacing = 10
								margin = { 8 8 }
								
								text_label_center = {
									text = "FAITH_DOCTRINE_CHANGE_WINDOW_CHOOSE_NEW"
								}
								
								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_enlightenment_virtues' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											blockoverride "doctrine_icon_texture" {
												texture = "[FaithDoctrine.GetIcon]"
											}
											datacontext = "[GetFaithDoctrine( 'doctrine_enlightenment_virtues_conscience_and_selfcontrol' )]"
										}
										button_vote_doctrine = { 
											blockoverride "doctrine_icon_texture" {
												texture = "[FaithDoctrine.GetIcon]"
											}
											datacontext = "[GetFaithDoctrine( 'doctrine_enlightenment_virtues_conviction_and_selfcontrol' )]"
										}
										button_vote_doctrine = { 
											blockoverride "doctrine_icon_texture" {
												texture = "[FaithDoctrine.GetIcon]"
											}
											datacontext = "[GetFaithDoctrine( 'doctrine_enlightenment_virtues_conscience_and_instinct' )]"
										}
										button_vote_doctrine = { 
											blockoverride "doctrine_icon_texture" {
												texture = "[FaithDoctrine.GetIcon]"
											}
											datacontext = "[GetFaithDoctrine( 'doctrine_enlightenment_virtues_conviction_and_instinct' )]"
										}
									}
								}
								
								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_vampirethemasquerade' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirethemasquerade_strict' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirethemasquerade_lax' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirethemasquerade_none' )]"
										}
									}
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirethemasquerade_cult' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirethemasquerade_family' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirethemasquerade_consent' )]"
										}
									}
								}
							}
							
							vbox = {
								name = "crime_doctrines_selection"
								visible = "[GetVariableSystem.HasValue('doctrine_tab_choice', 'crimes')]"
								spacing = 10
								margin = { 8 8 }
								
								text_label_center = {
									text = "FAITH_DOCTRINE_CHANGE_WINDOW_CHOOSE_NEW"
								}
								
								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_vampirediablerie' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirediablerie_crime' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirediablerie_shunned' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirediablerie_accepted' )]"
										}
									}
								}

								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_vampirefrenzy' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirefrenzy_crime' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirefrenzy_shunned' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirefrenzy_accepted' )]"
										}
									}
								}

								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_vampirethinblood' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirethinblood_crime' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirethinblood_shunned' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirethinblood_accepted' )]"
										}
									}
								}

								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_vampirebloodoath' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirebloodoath_crime' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirebloodoath_shunned' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampirebloodoath_accepted' )]"
										}
									}
								}

								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_vampireghouling' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampireghouling_crime' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampireghouling_shunned' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampireghouling_accepted' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_vampireghouling_mass' )]"
										}
									}
								}

								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_bloodsorcery' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_bloodsorcery_crime' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_bloodsorcery_shunned' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_bloodsorcery_accepted' )]"
										}
									}
								}

								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_infernalism' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_infernalism_crime' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_infernalism_shunned' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_infernalism_accepted' )]"
										}
									}
								}
							}

							vbox = {
								name = "splat_doctrines_selection"
								visible = "[GetVariableSystem.HasValue('doctrine_tab_choice', 'splats')]"
								spacing = 10
								margin = { 8 8 }
								
								text_label_center = {
									text = "FAITH_DOCTRINE_CHANGE_WINDOW_CHOOSE_NEW"
								}

								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_demonic' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_demonic_crime' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_demonic_shunned' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_demonic_accepted' )]"
										}
									}
								}

								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_fera' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_fera_crime' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_fera_shunned' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_fera_accepted' )]"
										}
									}
								}

								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_magicraft' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_magicraft_crime' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_magicraft_shunned' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_magicraft_accepted' )]"
										}
									}
								}

								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_haunting' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_haunting_crime' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_haunting_shunned' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_haunting_accepted' )]"
										}
									}
								}

								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_glamour' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_glamour_crime' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_glamour_shunned' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_glamour_accepted' )]"
										}
									}
								}

								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_undying' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_undying_crime' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_undying_shunned' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_undying_accepted' )]"
										}
									}
								}

								vbox = {
									spacing = 5

									text_single = {
										raw_text = "[GetFaithDoctrineGroup( 'doctrine_kueijin' ).GetName( Faith.Self )]"
									}
									
									hbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10

										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_kueijin_crime' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_kueijin_shunned' )]"
										}
										button_vote_doctrine = { 
											datacontext = "[GetFaithDoctrine( 'doctrine_kueijin_accepted' )]"
										}
									}
								}
							}
						}
					}
					expand = {}
				}

				vbox = {
					name = "powerful_vassals"
					layoutpolicy_horizontal = expanding
					layoutpolicy_vertical = expanding
					margin = { 0 20 }

					background = {
						using = Background_Area
					}

					expand = {}

					vbox = {
						spacing = 6

						text_label_center = {
							text = "FAITH_DOCTRINE_CHANGE_WINDOW_POWERFUL_VASSALS"
						}

						text_multi = {
							text = "CONVENTION_OF_THORNS_WINDOW_ELECTOR_DESC"
							default_format = "#weak"
							autoresize = yes
							max_width = 500
						}
					}

					vbox = {
						layoutpolicy_horizontal = expanding
						margin_left = 28

						fixedgridbox = {
							name = "elector_box"
							datamodel = "[Faith.MakeScope.GetList('thorn_elector_list')]"
							layoutpolicy_horizontal = expanding

							addcolumn = 120
							addrow = 155
							datamodel_wrap = 8
							flipdirection = yes

							item = {
								flowcontainer = {
									datacontext = "[Scope.GetCharacter]"
									datacontext = "[GetScriptedGui( 'opposing_doctrine_vote' )]"
									direction = vertical

									portrait_head = {}

									flowcontainer = {
										visible = "[ScriptedGui.IsValid(GuiScope.SetRoot(Character.MakeScope).End)]"
										parentanchor = hcenter
										ignoreinvisible = yes
										tooltip = "CONVENTION_OF_THORNS_WINDOW_OPPOSE_TT"
										using = tooltip_se

										icon = {
											name = "X_opposing"
											size = { 30 30 }
											texture = "gfx/interface/icons/symbols/icon_cross.dds"
										}

										text_single = {
											name = "opposes"
											text = "CONVENTION_OF_THORNS_WINDOW_OPPOSE"
										}
									}

									flowcontainer = {
										visible = "[Not(ScriptedGui.IsValid(GuiScope.SetRoot(Character.MakeScope).End))]"
										parentanchor = hcenter
										ignoreinvisible = yes
										tooltip = "CONVENTION_OF_THORNS_WINDOW_APPROVE_TT"
										using = tooltip_se

										icon = {
											name = "X_approves"
											size = { 30 30 }
											texture = "gfx/interface/icons/symbols/icon_check.dds"
										}

										text_single = {
											name = "approves"
											text = "CONVENTION_OF_THORNS_WINDOW_APPROVE"
										}
									}
								}
							}
						}
					}

					expand = {}
				}
			}
		
			vbox = {
				name = "footer"
				layoutpolicy_horizontal = expanding
				margin_bottom = 12

				button_primary = {
					name = "enact_button"
					datacontext = "[GetScriptedGui( 'apply_voted_doctrine' )]"
					onclick = "[GetVariableSystem.Toggle( 'convention_of_thorns_doctrine_confirm' )]"
					enabled = "[Not(GetVariableSystem.Exists('convention_of_thorns_doctrine_confirm'))]"

					text = "CONVENTION_OF_THORNS_WINDOW_CHANGE"

					using = tooltip_above
					tooltip = "[ScriptedGui.BuildTooltip(GuiScope.SetRoot(Faith.MakeScope).AddScope('player',GetPlayer.MakeScope).End)]"
				}
			}
		}
	}
}

window = {
	name = "convention_of_thorns_confirm_tenet_window"
	layer = top
	parentanchor = center
	size = { 500 350 }
	visible = "[GetVariableSystem.Exists('convention_of_thorns_tenet_confirm')]"
	datacontext = "[GetFaithByKey( 'camahumanity' )]"
	window_convention_of_thorns_confirm = {
		datacontext = "[GetScriptedGui( 'apply_voted_tenet' )]"
		blockoverride "close_window"
		{
			onclick = "[GetVariableSystem.Clear('convention_of_thorns_tenet_confirm')]"
		}
	}
}

window = {
	name = "convention_of_thorns_confirm_doctrine_window"
	layer = top
	parentanchor = center
	size = { 500 350 }
	visible = "[GetVariableSystem.Exists('convention_of_thorns_doctrine_confirm')]"
	datacontext = "[GetFaithByKey( 'camahumanity' )]"
	window_convention_of_thorns_confirm = {
		datacontext = "[GetScriptedGui( 'apply_voted_doctrine' )]"
		blockoverride "close_window"
		{
			onclick = "[GetVariableSystem.Clear('convention_of_thorns_doctrine_confirm')]"
		}
	}
}

types Thorns
{
    type thorns_grid = dynamicgridbox
	{
		item = {
			container = {
				datacontext = "[Scope.FaithDoctrine]"
				hbox = {
					spacing = 10
					hbox = {
						layoutpolicy_horizontal = expanding
						layoutpolicy_vertical = expanding
						minimumsize = { 100 105 }
						using = tooltip_se
						tooltip = "FAITH_WINDOW_DOCTRINE_TOOLTIP"
						
						container = {
							
							highlight_icon = {
								name = "doctrine_group_icon"
								texture = "[FaithDoctrine.GetIcon]"
								size = { 65 100 }
								alpha = 0.85
								position = { 0 -15 }
								parentanchor = top|hcenter
							}

							text_label_center = {
								name = "doctrine_name"
								parentanchor = bottom|hcenter
								widgetanchor = center
								position = { 0 -12 }
								maximumsize = { 100 44 }
								fontsize_min = 9
								multiline = yes
								align = center
								elide = right
								text = "[FaithDoctrine.GetNameNoTooltip( Faith.Self )]"
								default_format = "#high"

								using = Font_Size_Medium
							}
						}
					}
					
					scrollarea = {
						minimumsize = { 800 105 }
						maximumsize = { 800 105 }
						autoresizescrollarea = yes
						scrollbarpolicy_vertical = always_off

						background = {
							using = Background_Area
						}

						scrollwidget = {
							dynamicgridbox = {
								layoutpolicy_horizontal = expanding
								layoutpolicy_vertical = expanding
								ignoreinvisible = yes
								
								datamodel = "[Faith.MakeScope.GetList('thorn_elector_list')]"
								datamodel_wrap = 1
								flipdirection = no

								item = {
									container = {
										datacontext = "[Scope.GetCharacter]"
										visible = "[GetScriptedGui( 'voted_this_tenet' ).IsShown(GuiScope.SetRoot(FaithDoctrine.MakeScope).AddScope('elector',Character.MakeScope).End)]"
										portrait_head = {
											size = { 100 100 }
											blockoverride "coa" {
												coa_dynasty_tiny = {
													datacontext = "[Character.GetHouse.GetDynasty]"
													parentanchor = bottom|left
													position = { 3 -2 }
													size = { 28 35 }
												}
											}
										}
									}
								}
							}
						}

						scrollbar_horizontal = {
							using = Scrollbar_Horizontal
						}
					}
				}
			}
		}
	}

    type button_vote_tenet = button_standard_hover
	{
		tooltip = "FAITH_DOCTRINE_GENERAL_TOOLTIP"
		datacontext = "[GetPlayer]"
		datacontext = "[GetScriptedGui( 'vote_tenet' )]"
		visible = "[EqualTo_string( FaithDoctrine.GetGroup.GetGroupingKey, 'core_tenets' )]"
		enabled = "[ScriptedGui.IsValid(GuiScope.SetRoot(FaithDoctrine.MakeScope).AddScope('elector',Character.MakeScope).End)]"
		onclick = "[ScriptedGui.Execute(GuiScope.SetRoot(FaithDoctrine.MakeScope).AddScope('elector',Character.MakeScope).End)]"
		
		size = { 300 150 }
		background = {
			using = Background_Area
			margin = { 5 5 }
		}

		hbox = {
			name = "faith_list_item"
			spacing = 5
			using = tooltip_nw
			tooltip = "FAITH_WINDOW_DOCTRINE_TOOLTIP"

			highlight_icon = {
				name = "doctrine_group_icon"
				texture = "[FaithDoctrine.GetIcon]"
				size = { 87 150 }
				alpha = 0.85
			}
			
			vbox = {
				layoutpolicy_horizontal = expanding

				text_single = {
					name = "doctrine_group_name"
					text = "[FaithDoctrine.GetName( Faith.Self )]"
					align = left
					default_format = "#low"
					layoutpolicy_horizontal = expanding
					autoresize = no
					fontsize_min = 12
				}

				text_single = {
					name = "faith_name"
					text = "[FaithDoctrine.GetNameNoTooltip( Faith.Self )]"
					layoutpolicy_horizontal = expanding
					elide = right
					autoresize = no
					fontsize_min = 12
					align = left
				}
			}
		}

		button_active_marker = {
			name = "victory_glow"
			visible = "[Faith.HasDoctrine( FaithDoctrine.Self )]"
		}

		icon = {
			name = "victory_glow2"
			visible = "[ScriptedGui.IsShown(GuiScope.SetRoot(FaithDoctrine.MakeScope).AddScope('elector',Character.MakeScope).End)]"
			size = { 100% 100% }
			texture = "gfx/interface/component_masks/mask_fade_circle.dds"
			using = Color_Orange
			alpha = 0.4
		}
	}
	
    type button_vote_doctrine = button_standard_hover
	{
		datacontext = "[GetScriptedGui( 'vote_doctrine' )]"
		
		tooltip = "FAITH_DOCTRINE_GENERAL_TOOLTIP"
		onclick = "[ScriptedGui.Execute(GuiScope.SetRoot(FaithDoctrine.MakeScope).AddScope('elector',Character.MakeScope).End)]"
		
		size = { 210 53 }
		background = {
			using = Background_Area
			margin = { 5 5 }
		}

		hbox = {
			name = "faith_list_item"
			spacing = 5
			using = tooltip_nw
			tooltip = "FAITH_WINDOW_DOCTRINE_TOOLTIP"

			icon_doctrine = {
				name = "doctrine_icon"
				size = { 50 50 }
				block "doctrine_icon_texture"
				{
					texture = "[FaithDoctrine.GetGroup.GetIcon]"
				}

				#alpha = "[Select_float( Faith.HasDoctrine( Faith.GetDoctrine ), '(float)0.4', '(float)1.0' )]"
			}

			vbox = {
				layoutpolicy_horizontal = expanding

				text_single = {
					name = "doctrine_group_name"
					text = "[FaithDoctrine.GetGroup.GetName( Faith.Self )]"
					align = left
					default_format = "#low"
					layoutpolicy_horizontal = expanding
					autoresize = no
					fontsize_min = 12
				}

				text_single = {
					name = "faith_name"
					text = "[FaithDoctrine.GetNameNoTooltip( Faith.Self )]"
					layoutpolicy_horizontal = expanding
					elide = right
					autoresize = no
					fontsize_min = 12
					align = left
				}
			}
		}

		button_active_marker = {
			name = "victory_glow"
			visible = "[Faith.HasDoctrine( FaithDoctrine.Self )]"
		}

		icon = {
			name = "victory_glow2"
			visible = "[Not(ScriptedGui.IsValid(GuiScope.SetRoot(FaithDoctrine.MakeScope).AddScope('elector',Character.MakeScope).End))]"
			size = { 100% 100% }
			texture = "gfx/interface/component_masks/mask_fade_circle.dds"
			using = Color_Orange
			alpha = 0.4
		}

		icon = {
			visible = "[ScriptedGui.IsShown(GuiScope.SetRoot(FaithDoctrine.MakeScope).AddScope('elector',Character.MakeScope).End)]"
			size = { 30 30 }
			parentanchor = bottom|right
			texture = "gfx/interface/icons/symbols/icon_check.dds"
		}
	}
	
	type window_convention_of_thorns_confirm = window {
		name = "convention_of_thorns_confirm_window"
		layer = confirmation
		allow_outside = yes
		size = { 500 350 }

		using = Window_Size_MainTab
		using = Window_Background
		using = Window_Decoration_Spike
		
		datacontext = "[GetFaithByKey( 'camahumanity' )]"

		vbox = {
			size = { 100% 100% }

			header_pattern = {
				layoutpolicy_horizontal = expanding

				blockoverride "header_text"
				{
					text = "CONVENTION_OF_THORNS_WINDOW_CONFIRM"
				}

				blockoverride "button_close"
				{
					visible = no
				}
			}
								
			scrollbox = {
				layoutpolicy_horizontal = expanding
				size = { 400 200 }
				maximumsize = { 400 200 }

				blockoverride "scrollbox_content"
				{
					text_label_left = {
						text = "[ScriptedGui.BuildTooltip(GuiScope.SetRoot(Faith.MakeScope).AddScope('player',GetPlayer.MakeScope).End)]"
						max_width = 380
						fontsize_min = 12
						multiline = yes
					}
				}
			}
			
			hbox = {
				name = "cancel_or_confirm"
				layoutpolicy_horizontal = expanding

				margin = { 16 0 }
				margin_bottom = 20
				spacing = 16

				expand = {}

				button_standard = {
					text = "CANCEL"

					block "close_window"
					{
					}
				}

				button_primary = {
					text = "CONFIRM"
					
					onclick = "[ScriptedGui.Execute(GuiScope.SetRoot(Faith.MakeScope).AddScope('player',GetPlayer.MakeScope).End)]"
					block "close_window"
					{
					}
				}

				expand = {}
			}
		}
	}
}
@portrait_shader_base_inverted_opacity = 0.2

@pod_bm_portrait_size = "['(CVector2f)225,171']" # 10% smaller than 250,190
@pod_bm_portrait_button_size = "['(CVector2f)270,252']" # 10% smaller than 300,280

template pod_bookmark_portrait_shader_animated {
	state = {
		name = "bookmark_character_hover_enter"
		duration = 0.15
		using = Animation_Curve_Default
		modify_texture = {
			name = "opacity"
			alpha = @portrait_shader_base_inverted_opacity
		}
	}
	state = {
		name = "bookmark_character_hover_leave"
		duration = 0.2
		using = Animation_Curve_Default
		modify_texture = {
			name = "opacity"
			alpha = 1
		}
	}
}

types PODVanillaBookmarkTypes
{
	type pod_bookmark_portrait_shader = icon {
		parentanchor = top|hcenter
		widgetanchor = bottom|hcenter
		position = { 0 50 }
		size = { 100% 60% }
		texture = "gfx/interface/colors/black.dds"
		
		block "shader" {
			shaderfile = "gfx/FX/POD_shaders/POD_event_shaders.shader"
			effectname = "FlowyBlood"
		}
		
		modify_texture = {
			texture = "gfx/interface/component_masks/mask_fade_halfcircle.dds"
			blend_mode = alphamultiply
			mirror = vertical
		}
		
		modify_texture = {
			name = "opacity"
			texture = "gfx/interface/transparent_pixel.dds"
			blend_mode = alphamultiply
			block "inverted_opacity" { alpha = @portrait_shader_base_inverted_opacity }
		}
	}
	
	type pod_bookmark_portrait_backgrounds = widget {
		size = { 100% 100% }
		scale = 0.9
		
		# Black background to make the shader pop (with mouseover animation)
		icon = {
			name = "portrait_black_glow"
			visible = "[Not(GameSetup.IsCharacterSelected( BookmarkCharacter.Self ))]"
			
			parentanchor = top|hcenter
			widgetanchor = bottom|hcenter
			position = { 0 50 }
			size = { 100% 60% }
			texture = "gfx/interface/component_masks/mask_fade_halfcircle.dds"
			color = { 0.0 0.0 0.0 1.0 }
			alpha = 0.3
			
			mirror = vertical
			
			state = {
				name = "bookmark_character_hover_enter"
				alpha = 1
				duration = 0.15
				using = Animation_Curve_Default
			}

			state = {
				trigger_on_create = yes
				name = "bookmark_character_hover_leave"
				alpha = 0.3
				duration = 0.2
				using = Animation_Curve_Default
			}
		}

		# Black background to make the shader pop (no animation, for the selected character)
		icon = {
			visible = "[GameSetup.IsCharacterSelected( BookmarkCharacter.Self )]"
			parentanchor = top|hcenter
			widgetanchor = bottom|hcenter
			position = { 0 50 }
			size = { 100% 60% }
			texture = "gfx/interface/component_masks/mask_fade_halfcircle.dds"
			color = { 0.0 0.0 0.0 1.0 }
			mirror = vertical
		}

		# Flowy red background (with mouseover animation)
		pod_bookmark_portrait_shader = {
			name = "portrait_hover_shader_red"
			visible = "[And( Not(GameSetup.IsCharacterSelected( BookmarkCharacter.Self )), BookmarkCharacterGlowsRed )]"
			blockoverride "shader" {
				shaderfile = "gfx/FX/POD_shaders/POD_event_shaders.shader"
				effectname = "FlowyBlood"
			}
			blockoverride "inverted_opacity" { alpha = 1 }
			using = pod_bookmark_portrait_shader_animated
		}
		# Flowy red background (no animation, for the selected character)
		pod_bookmark_portrait_shader = {
			visible = "[And( GameSetup.IsCharacterSelected( BookmarkCharacter.Self ), BookmarkCharacterGlowsRed )]"
			blockoverride "shader" {
				shaderfile = "gfx/FX/POD_shaders/POD_event_shaders.shader"
				effectname = "FlowyBlood"
			}
		}

		# Flowy gold background (with mouseover animation)
		pod_bookmark_portrait_shader = {
			name = "portrait_hover_shader_gold"
			visible = "[And( Not(GameSetup.IsCharacterSelected( BookmarkCharacter.Self )), BookmarkCharacterGlowsGold )]"
			blockoverride "shader" {
				shaderfile = "gfx/FX/POD_shaders/POD_event_shaders.shader"
				effectname = "FlowyGold"
			}
			blockoverride "inverted_opacity" { alpha = 1 }
			using = pod_bookmark_portrait_shader_animated
		}
		# Flowy gold background (no animation, for the selected character)
		pod_bookmark_portrait_shader = {
			visible = "[And( GameSetup.IsCharacterSelected( BookmarkCharacter.Self ), BookmarkCharacterGlowsGold )]"
			blockoverride "shader" {
				shaderfile = "gfx/FX/POD_shaders/POD_event_shaders.shader"
				effectname = "FlowyGold"
			}
		}

		# Flowy green background (with mouseover animation)
		pod_bookmark_portrait_shader = {
			name = "portrait_hover_shader_green"
			visible = "[And( Not(GameSetup.IsCharacterSelected( BookmarkCharacter.Self )), BookmarkCharacterGlowsGreen )]"
			blockoverride "shader" {
				shaderfile = "gfx/FX/POD_shaders/POD_event_shaders.shader"
				effectname = "FlowyRitual"
			}
			blockoverride "inverted_opacity" { alpha = 1 }
			using = pod_bookmark_portrait_shader_animated
		}
		# Flowy green background (no animation, for the selected character)
		pod_bookmark_portrait_shader = {
			visible = "[And( GameSetup.IsCharacterSelected( BookmarkCharacter.Self ), BookmarkCharacterGlowsGreen )]"
			blockoverride "shader" {
				shaderfile = "gfx/FX/POD_shaders/POD_event_shaders.shader"
				effectname = "FlowyRitual"
			}
		}
	}
	
	type pod_bookmark_portrait_effects = widget {
		size = { 100% 100% }

		# Red lighting (with mouseover animation)
		bm_portrait = {
			name = "portrait_hover_effect_red"
			visible = "[And3( BookmarkCharacter.HasPortrait, Not(GameSetup.IsCharacterSelected( BookmarkCharacter.Self )), BookmarkCharacterGlowsRed )]"
			alpha = 0
			
			state = {
				name = "bookmark_character_hover_enter"
				alpha = 1
				duration = 0.15
				using = Animation_Curve_Default
			}

			state = {
				name = "bookmark_character_hover_leave"
				alpha = 0
				duration = 0.2
				using = Animation_Curve_Default
			}

			parentanchor = bottom|hcenter
			size = @pod_bm_portrait_size
			alwaystransparent = yes

			blockoverride "portrait_button"
			{
				portrait_texture = "[BookmarkCharacter.GetPortrait( 'POD_environment_event_blood', 'camera_hud', PdxGetWidgetScreenSize(PdxGuiWidget.Self) )]"
				size = @pod_bm_portrait_button_size
				mask = "gfx/portraits/portrait_mask_torso.dds"
			}
		}
		
		# Red lighting (no animation, for the selected character)
		bm_portrait = {
			visible = "[And3( BookmarkCharacter.HasPortrait, GameSetup.IsCharacterSelected( BookmarkCharacter.Self ), BookmarkCharacterGlowsRed )]"

			parentanchor = bottom|hcenter
			size = @pod_bm_portrait_size
			alwaystransparent = yes

			blockoverride "portrait_button"
			{
				portrait_texture = "[BookmarkCharacter.GetPortrait( 'POD_environment_event_blood', 'camera_hud', PdxGetWidgetScreenSize(PdxGuiWidget.Self) )]"
				size = @pod_bm_portrait_button_size
				mask = "gfx/portraits/portrait_mask_torso.dds"
			}
		}

		# Gold lighting (with mouseover animation)
		bm_portrait = {
			name = "portrait_hover_effect_gold"
			visible = "[And3( BookmarkCharacter.HasPortrait, Not(GameSetup.IsCharacterSelected( BookmarkCharacter.Self )), BookmarkCharacterGlowsGold )]"
			alpha = 0
			
			state = {
				name = "bookmark_character_hover_enter"
				alpha = 1
				duration = 0.15
				using = Animation_Curve_Default
			}

			state = {
				name = "bookmark_character_hover_leave"
				alpha = 0
				duration = 0.2
				using = Animation_Curve_Default
			}

			parentanchor = bottom|hcenter
			size = @pod_bm_portrait_size
			alwaystransparent = yes

			blockoverride "portrait_button"
			{
				portrait_texture = "[BookmarkCharacter.GetPortrait( 'POD_environment_bookmark_gold', 'camera_hud', PdxGetWidgetScreenSize(PdxGuiWidget.Self) )]"
				size = @pod_bm_portrait_button_size
				mask = "gfx/portraits/portrait_mask_torso.dds"
			}
		}
		
		# Gold lighting (no animation, for the selected character)
		bm_portrait = {
			visible = "[And3( BookmarkCharacter.HasPortrait, GameSetup.IsCharacterSelected( BookmarkCharacter.Self ), BookmarkCharacterGlowsGold )]"

			parentanchor = bottom|hcenter
			size = @pod_bm_portrait_size
			alwaystransparent = yes

			blockoverride "portrait_button"
			{
				portrait_texture = "[BookmarkCharacter.GetPortrait( 'POD_environment_bookmark_gold', 'camera_hud', PdxGetWidgetScreenSize(PdxGuiWidget.Self) )]"
				size = @pod_bm_portrait_button_size
				mask = "gfx/portraits/portrait_mask_torso.dds"
			}
		}

		# Green lighting (with mouseover animation)
		bm_portrait = {
			name = "portrait_hover_effect_green"
			visible = "[And3( BookmarkCharacter.HasPortrait, Not(GameSetup.IsCharacterSelected( BookmarkCharacter.Self )), BookmarkCharacterGlowsGreen )]"
			alpha = 0
			
			state = {
				name = "bookmark_character_hover_enter"
				alpha = 1
				duration = 0.15
				using = Animation_Curve_Default
			}

			state = {
				name = "bookmark_character_hover_leave"
				alpha = 0
				duration = 0.2
				using = Animation_Curve_Default
			}

			parentanchor = bottom|hcenter
			size = @pod_bm_portrait_size
			alwaystransparent = yes

			blockoverride "portrait_button"
			{
				portrait_texture = "[BookmarkCharacter.GetPortrait( 'POD_environment_bookmark_green', 'camera_hud', PdxGetWidgetScreenSize(PdxGuiWidget.Self) )]"
				size = @pod_bm_portrait_button_size
				mask = "gfx/portraits/portrait_mask_torso.dds"
			}
		}
		
		# Green lighting (no animation, for the selected character)
		bm_portrait = {
			visible = "[And3( BookmarkCharacter.HasPortrait, GameSetup.IsCharacterSelected( BookmarkCharacter.Self ), BookmarkCharacterGlowsGreen )]"

			parentanchor = bottom|hcenter
			size = @pod_bm_portrait_size
			alwaystransparent = yes

			blockoverride "portrait_button"
			{
				portrait_texture = "[BookmarkCharacter.GetPortrait( 'POD_environment_bookmark_green', 'camera_hud', PdxGetWidgetScreenSize(PdxGuiWidget.Self) )]"
				size = @pod_bm_portrait_button_size
				mask = "gfx/portraits/portrait_mask_torso.dds"
			}
		}
	}
}
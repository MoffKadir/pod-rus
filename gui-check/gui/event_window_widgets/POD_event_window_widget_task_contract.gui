# Usage:
# The task_contract needs to be saved as scope:task_contract
# Then put these effects in the immediate and after blocks of the event, respectively:
# POD_save_task_contract_for_event_widget = yes
# POD_cleanup_task_contract_event_widget  = yes

vbox = {
	name = "POD_event_window_widget_task_contract"
	layoutpolicy_horizontal = expanding
	margin_bottom = 26

	state = {
		name = init
		trigger_on_create = yes
		# Set coterie status
		on_start = "[PlayerGuiExecute('POD_set_coterie_status_sgui')]"
	}
	
	vbox = {
		datacontext = "[GetPlayer.MakeScope.Var('task_contract_widget').TaskContract]"
		
		margin_left = 48
		margin_right = 48
		margin_bottom = 24
		
		layoutpolicy_horizontal = expanding
		
		hbox = {
			layoutpolicy_horizontal = expanding
			
			button_task_contract_banner = {
				size = { 70 70 }
				using = tooltip_ws
			}
			
			spacer = { size = { 8 0 } }
			
			button_primary = {
				datacontext = "[TaskContract.GetLocation.GetCounty.GetTitle]"
				
				layoutpolicy_horizontal = expanding
				size = { 0 50 }
				
				onclick = "[DefaultOnCoatOfArmsClick(Title.GetID)]"
				tooltipwidget = { using = LandedTitleTooltip }
				using = State_Title_MouseEntry

				widget = {
					parentanchor = center
					size = { 100% 100% }
	
					using = Background_Letter
				}
				
				hbox = {
					margin_left = 16
					
					coa_title_tiny = {
					}

					text_single = {
						margin_left = 8
						margin_bottom = 3
                        default_format = "#light_background"
						text = "[Title.GetNameNoTierNoTooltip]"
					}
					
					expand = {}
				}
			}
		}
		
		hbox = {
			layoutpolicy_horizontal = expanding
			#margin_top = 8
			
			visible = "[PlayerGuiIsValid('POD_is_available_sgui')]"
			
			expand = {}
			
			text_multi = {
				visible = "[Not( PlayerGuiIsValid('POD_has_coterie_members_sgui') )]"
				align = top|hcenter
				autoresize = yes
				maximumsize = { 360 -1 }
				layoutpolicy_horizontal = expanding
				text = "[GetPlayer.Custom('PODCoterieTravelStatusGUISimplified')]"
			}
			
			text_single = {
				visible = "[PlayerGuiIsValid('POD_has_coterie_members_sgui')]"
				margin_bottom = 5
				text = "[GetPlayer.Custom('PODCoterieTravelStatusGUISimplified')]"
			}
			
			widget = {
				visible = "[PlayerGuiIsValid('POD_has_coterie_members_sgui')]"
				min_width = 6
			}
			
			button_checkbox = {
				visible = "[PlayerGuiIsValid('POD_has_coterie_members_sgui')]"
				size = { 24 24 }
				checked = "[GetPlayer.MakeScope.Var('traveling_with_coterie').IsSet]"
				onclick = "[PlayerGuiExecute('POD_toggle_coterie_travel')]"
				tooltip = "POD_journey_coterie_checkbox_tt"
			}
			
			expand = {}
		}

		widget = {
			layoutpolicy_horizontal = expanding
			min_height = 24

			hbox = {
				margin_top = 8
				# disable domicile traveling for now since lots of journey code would need to be rewritten
				visible = no
				#visible = "[And( PlayerGuiIsValid('POD_is_available_sgui'), PlayerGuiIsValid('POD_journey_can_move_camp_sgui') )]"
				layoutpolicy_horizontal = expanding
	
				expand = {}
	
				text_single = {
					margin_bottom = 5
					text = "POD_journey_move_camp"
				}
	
				widget = {
					min_width = 6
				}
				
				button_checkbox = {
					size = { 24 24 }
					checked = "[GetPlayer.MakeScope.Var('journey_moves_camp').IsSet]"
					onclick = "[PlayerGuiExecute('POD_toggle_journey_moving_camp')]"
					tooltip = "POD_journey_move_camp_tt"
				}
			
				expand = {}
			}
		}
	}
}